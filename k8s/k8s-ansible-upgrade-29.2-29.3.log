MASTER: 


% ansible-playbook k8s-master.yaml 

PLAY [upgrade kubernetes cluster] **************************************************************************************************************************************************

TASK [apt update] ******************************************************************************************************************************************************************
changed: [k8sm1]

TASK [unhold kubeadm] **************************************************************************************************************************************************************
changed: [k8sm1]

TASK [kill apiserver] **************************************************************************************************************************************************************
changed: [k8sm1]

TASK [upgrade kubeadm] *************************************************************************************************************************************************************
changed: [k8sm1]

TASK [hold kubeadm] ****************************************************************************************************************************************************************
changed: [k8sm1]

TASK [wait for apiserver] **********************************************************************************************************************************************************
changed: [k8sm1]

TASK [kubeadm upgrade] *************************************************************************************************************************************************************
changed: [k8sm1]

TASK [drain the node] **************************************************************************************************************************************************************
changed: [k8sm1]

TASK [unhold kubelet] **************************************************************************************************************************************************************
changed: [k8sm1]

TASK [unhold kubectl] **************************************************************************************************************************************************************
changed: [k8sm1]

TASK [upgrade kubelet] *************************************************************************************************************************************************************
changed: [k8sm1]

TASK [upgrade kubectl] *************************************************************************************************************************************************************
changed: [k8sm1]

TASK [hold kubelet] ****************************************************************************************************************************************************************
changed: [k8sm1]

TASK [hold kubectl] ****************************************************************************************************************************************************************
changed: [k8sm1]

TASK [daemon reload] ***************************************************************************************************************************************************************
changed: [k8sm1]

TASK [restart kubelet] *************************************************************************************************************************************************************
changed: [k8sm1]

TASK [uncordon the node] ***********************************************************************************************************************************************************
changed: [k8sm1]

PLAY RECAP *************************************************************************************************************************************************************************
k8sm1                      : ok=17   changed=17   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   




WORKERS: 

% ansible-playbook k8s-workers.yaml

PLAY [upgrade kubernetes cluster] **************************************************************************************************************************************************

TASK [apt update] ******************************************************************************************************************************************************************
ok: [k8sw1]

TASK [unhold kubeadm] **************************************************************************************************************************************************************
changed: [k8sw1]

TASK [upgrade kubeadm] *************************************************************************************************************************************************************
ok: [k8sw1]

TASK [hold kubeadm] ****************************************************************************************************************************************************************
changed: [k8sw1]

TASK [drain the node] **************************************************************************************************************************************************************
changed: [k8sw1]

TASK [upgrade node] ****************************************************************************************************************************************************************
changed: [k8sw1]

TASK [unhold kubelet] **************************************************************************************************************************************************************
changed: [k8sw1]

TASK [unhold kubectl] **************************************************************************************************************************************************************
changed: [k8sw1]

TASK [upgrade kubelet] *************************************************************************************************************************************************************
ok: [k8sw1]

TASK [upgrade kubectl] *************************************************************************************************************************************************************
ok: [k8sw1]

TASK [hold kubelet] ****************************************************************************************************************************************************************
changed: [k8sw1]

TASK [hold kubectl] ****************************************************************************************************************************************************************
changed: [k8sw1]

TASK [daemon reload] ***************************************************************************************************************************************************************
changed: [k8sw1]

TASK [restart kubelet] *************************************************************************************************************************************************************
changed: [k8sw1]

TASK [uncordon the node] ***********************************************************************************************************************************************************
changed: [k8sw1]

TASK [sleep 15sec] *****************************************************************************************************************************************************************
changed: [k8sw1]

PLAY [upgrade kubernetes cluster] **************************************************************************************************************************************************

TASK [apt update] ******************************************************************************************************************************************************************
ok: [k8sw2]

TASK [unhold kubeadm] **************************************************************************************************************************************************************
changed: [k8sw2]

TASK [upgrade kubeadm] *************************************************************************************************************************************************************
ok: [k8sw2]

TASK [hold kubeadm] ****************************************************************************************************************************************************************
changed: [k8sw2]

TASK [drain the node] **************************************************************************************************************************************************************
changed: [k8sw2]

TASK [upgrade node] ****************************************************************************************************************************************************************
changed: [k8sw2]

TASK [unhold kubelet] **************************************************************************************************************************************************************
changed: [k8sw2]

TASK [unhold kubectl] **************************************************************************************************************************************************************
changed: [k8sw2]

TASK [upgrade kubelet] *************************************************************************************************************************************************************
ok: [k8sw2]

TASK [upgrade kubectl] *************************************************************************************************************************************************************
ok: [k8sw2]

TASK [hold kubelet] ****************************************************************************************************************************************************************
changed: [k8sw2]

TASK [hold kubectl] ****************************************************************************************************************************************************************
changed: [k8sw2]

TASK [daemon reload] ***************************************************************************************************************************************************************
changed: [k8sw2]

TASK [restart kubelet] *************************************************************************************************************************************************************
changed: [k8sw2]

TASK [uncordon the node] ***********************************************************************************************************************************************************
changed: [k8sw2]

TASK [sleep 15sec] *****************************************************************************************************************************************************************
changed: [k8sw2]

PLAY [upgrade kubernetes cluster] **************************************************************************************************************************************************

TASK [apt update] ******************************************************************************************************************************************************************
ok: [k8sw3]

TASK [unhold kubeadm] **************************************************************************************************************************************************************
changed: [k8sw3]

TASK [upgrade kubeadm] *************************************************************************************************************************************************************
changed: [k8sw3]

TASK [hold kubeadm] ****************************************************************************************************************************************************************
changed: [k8sw3]

TASK [drain the node] **************************************************************************************************************************************************************
changed: [k8sw3]

TASK [upgrade node] ****************************************************************************************************************************************************************
changed: [k8sw3]

TASK [unhold kubelet] **************************************************************************************************************************************************************
changed: [k8sw3]

TASK [unhold kubectl] **************************************************************************************************************************************************************
changed: [k8sw3]

TASK [upgrade kubelet] *************************************************************************************************************************************************************
changed: [k8sw3]

TASK [upgrade kubectl] *************************************************************************************************************************************************************
changed: [k8sw3]

TASK [hold kubelet] ****************************************************************************************************************************************************************
changed: [k8sw3]

TASK [hold kubectl] ****************************************************************************************************************************************************************
changed: [k8sw3]

TASK [daemon reload] ***************************************************************************************************************************************************************
changed: [k8sw3]

TASK [restart kubelet] *************************************************************************************************************************************************************
changed: [k8sw3]

TASK [uncordon the node] ***********************************************************************************************************************************************************
changed: [k8sw3]

TASK [sleep 15sec] *****************************************************************************************************************************************************************
changed: [k8sw3]

PLAY [upgrade kubernetes cluster] **************************************************************************************************************************************************

TASK [apt update] ******************************************************************************************************************************************************************
ok: [k8sw4]

TASK [unhold kubeadm] **************************************************************************************************************************************************************
changed: [k8sw4]

TASK [upgrade kubeadm] *************************************************************************************************************************************************************
changed: [k8sw4]

TASK [hold kubeadm] ****************************************************************************************************************************************************************
changed: [k8sw4]

TASK [drain the node] **************************************************************************************************************************************************************
changed: [k8sw4]

TASK [upgrade node] ****************************************************************************************************************************************************************
changed: [k8sw4]

TASK [unhold kubelet] **************************************************************************************************************************************************************
changed: [k8sw4]

TASK [unhold kubectl] **************************************************************************************************************************************************************
changed: [k8sw4]

TASK [upgrade kubelet] *************************************************************************************************************************************************************
changed: [k8sw4]

TASK [upgrade kubectl] *************************************************************************************************************************************************************
changed: [k8sw4]

TASK [hold kubelet] ****************************************************************************************************************************************************************
changed: [k8sw4]

TASK [hold kubectl] ****************************************************************************************************************************************************************
changed: [k8sw4]

TASK [daemon reload] ***************************************************************************************************************************************************************
changed: [k8sw4]

TASK [restart kubelet] *************************************************************************************************************************************************************
changed: [k8sw4]

TASK [uncordon the node] ***********************************************************************************************************************************************************
changed: [k8sw4]

TASK [sleep 15sec] *****************************************************************************************************************************************************************
changed: [k8sw4]

PLAY RECAP *************************************************************************************************************************************************************************
k8sw1                      : ok=16   changed=12   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
k8sw2                      : ok=16   changed=12   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
k8sw3                      : ok=16   changed=15   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
k8sw4                      : ok=16   changed=15   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0



FINAL OUTPUT: 

NAME    STATUS   ROLES           AGE   VERSION   INTERNAL-IP      EXTERNAL-IP   OS-IMAGE                         KERNEL-VERSION   CONTAINER-RUNTIME
k8sm1   Ready    control-plane   27d   v1.29.3   10.206.112.202   <none>        Debian GNU/Linux 12 (bookworm)   6.1.0-18-amd64   containerd://1.6.28
k8sw1   Ready    <none>          27d   v1.29.3   10.206.112.205   <none>        Debian GNU/Linux 12 (bookworm)   6.1.0-18-amd64   containerd://1.6.28
k8sw2   Ready    <none>          27d   v1.29.3   10.206.112.206   <none>        Debian GNU/Linux 12 (bookworm)   6.1.0-18-amd64   containerd://1.6.28
k8sw3   Ready    <none>          27d   v1.29.3   10.206.112.207   <none>        Debian GNU/Linux 12 (bookworm)   6.1.0-18-amd64   containerd://1.6.28
k8sw4   Ready    <none>          27d   v1.29.3   10.206.112.208   <none>        Debian GNU/Linux 12 (bookworm)   6.1.0-18-amd64   containerd://1.6.28


NAME                        READY   STATUS    RESTARTS   AGE    IP            NODE    NOMINATED NODE   READINESS GATES
frontend-6f5f4b44ff-6rptz   1/1     Running   0          34s    10.77.77.31   k8sw3   <none>           <none>
frontend-6f5f4b44ff-6t46z   1/1     Running   0          103s   10.77.77.37   k8sw1   <none>           <none>
frontend-6f5f4b44ff-9m84v   1/1     Running   0          72s    10.77.77.36   k8sw2   <none>           <none>
frontend-6f5f4b44ff-ccxds   1/1     Running   0          103s   10.77.77.38   k8sw1   <none>           <none>
frontend-6f5f4b44ff-jzlhg   1/1     Running   0          72s    10.77.77.35   k8sw2   <none>           <none>
frontend-6f5f4b44ff-kl9bd   1/1     Running   0          34s    10.77.77.32   k8sw3   <none>           <none>



